This is a fork.  See commits for changes I'm making. 
